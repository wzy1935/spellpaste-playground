需求1 主窗口

快捷键按下后，需调用复制并窗口呼出；选择spell后会自动退出并使焦点返回原窗口并调用粘贴

---

## Playground 实现记录

**位置：** `playground/`

**快捷键：** `Ctrl+Space`

### 实现方案

| 功能 | 方案 | 相关代码 |
|------|------|---------|
| 全局快捷键 | `tauri-plugin-global-shortcut` | `lib.rs` setup |
| 模拟 Ctrl+C / Ctrl+V | `enigo 0.2` | `lib.rs` |
| 保存/恢复焦点窗口 | `winapi::GetForegroundWindow` / `SetForegroundWindow` | `lib.rs` |
| 窗口呼出/隐藏 | Tauri `window.show()` / `window.hide()` | `lib.rs: apply_spell` |

### 触发流程

```
Ctrl+Space 按下
  → GetForegroundWindow() 保存原窗口句柄
  → 模拟 Ctrl+C（此时焦点仍在原窗口）
  → sleep 100ms（等待剪贴板更新）
  → window.show() + set_focus()

用户点击 Apply Spell
  → window.hide()
  → SetForegroundWindow(saved_hwnd)
  → sleep 50ms（等待焦点切换）
  → 模拟 Ctrl+V
```

### 窗口配置

- `visible: false` — 默认隐藏
- `decorations: false` — 无标题栏
- `alwaysOnTop: true` — 始终置顶
- `skipTaskbar: true` — 不在任务栏显示
- `center: true` — 居中弹出
- 尺寸：600 × 80

### 待验证（手动测试）

- [ ] 快捷键在各类 app 中均可触发（浏览器、原生、Electron）
- [ ] 剪贴板内容正确复制
- [ ] 焦点正确返回原窗口后粘贴生效
- [ ] `Ctrl+Space` 是否与系统/其他 app 快捷键冲突